<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640">

    <link rel="stylesheet" href="stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">
    <link rel="stylesheet" href="stylesheets/github-light.css">

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>seajs 模块化 by Bboom1024</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/Bboom1024/Bboom.github.io">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>seajs 模块化</h1>
            <h2>seaJS初步学习</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/Bboom1024/Bboom.github.io/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/Bboom1024/Bboom.github.io/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <hr>

<h3>
<a id="一开发场景" class="anchor" href="#%E4%B8%80%E5%BC%80%E5%8F%91%E5%9C%BA%E6%99%AF" aria-hidden="true"><span class="octicon octicon-link"></span></a>一、开发场景</h3>

<p>1、js命名冲突
命名空间可以一定程度的解决这个问题</p>

<p>2、插件依赖
show.js依赖a.js，但开发show.js忘记告诉你使用show.js前要导入a.js。
另一个严重的问题是，开发后期需要对show.js进行扩展,新的扩展需要依赖b.js，这时候需要去以前的页面再重新添加上b.js</p>

<h3>
<a id="二seajs小例子" class="anchor" href="#%E4%BA%8Cseajs%E5%B0%8F%E4%BE%8B%E5%AD%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>二、seajs小例子</h3>

<p>文件结构如下：
<img src="http://b.picphotos.baidu.com/album/h%3D80%3Bq%3D90/sign=5be48ab3ef50352aae6128086832c6cb/a08b87d6277f9e2f661f980c1930e924b899f388.jpg" alt=""></p>

<p>index.html代码</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;title&gt;seajs&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;script type="text/javascript" src="http://apps.bdimg.com/libs/seajs/2.3.0/sea.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
      //seajs.use('main');          //主入口文件，相对于sea.js位置
        seajs.use('./js/main');     //主入口文件，相对于html位置
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>main.js 代码</p>

<pre><code>define(function(require, exports, module) {
    var commonJs = require('./common');
    commonJs.saySomething();
});
</code></pre>

<p>common.js 代码</p>

<pre><code>define(function(require, exports, module) {
    exports.saySomething = function() {
        console.log('this is commonjs');
    }
});
</code></pre>

<h3>
<a id="三seajs简短使用说明" class="anchor" href="#%E4%B8%89seajs%E7%AE%80%E7%9F%AD%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a>三、seajs简短使用说明</h3>

<p>1、每个html中使用 seajs.use 来加载一个或者多个模块，模块名为对应的js文件名，可以省略.js后缀。也可以有seajs.config()来做相应的一些配置</p>

<p>2、每个模块的书写格式，每个模块建议写为一个单独的js文件</p>

<pre><code>define(function(require, exports, module) {
    /* code */
});
</code></pre>

<p>参数<a href="https://github.com/parm" class="user-mention">@parm</a>说明
<code>require</code> 用于导入该模块需要的依赖
<code>exports</code> 用于为其他模块调用提供接口
<code>module</code>  一些可以调试的信息，包括该模块的id、模块的路径、模块的依赖、对外接口等信息
以上三个参数可以开发中建议全写上</p>

<h3>
<a id="四seajs的自动化工具" class="anchor" href="#%E5%9B%9Bseajs%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7" aria-hidden="true"><span class="octicon octicon-link"></span></a>四、seajs的自动化工具</h3>

<p>由于seajs开发过程中是通过文件名来区分模块，势必会涉及一个页面导入js文件过多的现象，这时候需要自动化工具进行必要的js合并</p>

<p>（1）不使用cmd插件合并的方法（不推荐）
需要去为每个模块的定义别名
以maim.js为例子，原代码</p>

<pre><code>define(function(require, exports, module) {
    var commonJs = require('./common');
    commonJs.saySomething();
});
</code></pre>

<p>改为</p>

<pre><code>define('./js/main',['./common']function(require, exports, module) {
    var commonJs = require('./common');
    commonJs.saySomething();
});
</code></pre>

<p>说明 <code>第一个参数</code>为该模块的ID别名， <code>第二个参数</code>为该模块所需要的依赖，其实这种写法才是完整的写法，只是前两个参数可以省略</p>

<p>（2）使用cmd插件合并的方法</p>

<ul>
<li>grunt插件 <code>grunt-cmd-transport</code> 和 <code>grunt-cmd-concat</code>  <a href="https://github.com/seajs/seajs/issues/538">教程链接</a>。</li>
<li>gulp插件 <code>gulp-seajs-combo</code> <a href="https://www.npmjs.com/package/gulp-seajs-combo/">教程链接</a> 。里面例子有个错误<code>.pipe( gulp.task('build/js') );</code>改为<code>.pipe( gulp.dest('build/js') )</code>
</li>
</ul>

<p><strong>grunt插件</strong>
 <code>grunt-cmd-transport</code> cmd语法转换，完成的任务就是上面说的模块别名改动，grunt自动帮我们完成
 <code>grunt-cmd-concat</code> 完成cmd文件的合并</p>

<p><strong>gulp插件</strong>
<code>gulp-seajs-combo</code> 只需要对main.js操作就可以，gulp会自动将其需要的依赖合并</p>

<p>【<strong>待解决问题</strong>】js合并压缩后我们一般都是以.min.js为后缀，这样又会导致主入口文件找不到文件的现象
以main.js压缩为例子，压缩后为main.min.js，主入口还是会认为去找main.js文件
现在测试下面几种方法可行</p>

<ul>
<li>修改主入口文件名字，不要以.min.js为后缀，缺点：不符合正常的命名规范</li>
<li>修改seajs的主入口，改为<code>seajs.use('main.min')</code>，同时修改main.min.js文件中<code>id=main</code>模块，缺点：每次压缩后都需要进行这个操作（不推荐）</li>
<li>使用seajs的配置设置，缺点：每个文件都需要做配置，线上的可行，但线下的又需要把配置去掉了</li>
</ul>

<pre><code>seajs.config({
    base: "./dist/",
    alias: {
        'main': 'main.min'  // 别名：文件名
    },
});
seajs.use('main');
</code></pre>

<p>有好的办法的同事请补充</p>

<h3>
<a id="五如何使用不符合cmd的插件" class="anchor" href="#%E4%BA%94%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%B8%8D%E7%AC%A6%E5%90%88cmd%E7%9A%84%E6%8F%92%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>五、如何使用不符合cmd的插件</h3>

<p>比如jquery，从官网下载的是不能直接使用在seajs里面，需要我们对其进行改造( T.T )，jquery默认是支持AMD规范的赶脚
<a href="https://github.com/seajs/seajs/issues/971">官网改造教程</a></p>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/Bboom1024">Bboom1024</a> can be found on <a href="https://github.com/Bboom1024/Bboom.github.io">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="https://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

    
  </body>
</html>
